# Hedging-of-sold-call-option

This script is written to solve the problem of delta hedging of a one sold call option on a selected stock with a specified strike price, the start date of the delta hedging process and the expiration date of the option, a specified risk-free rate and the number of years of history, which is used to find the optimal point in time in the past to calculate the volatility of the underlying stock. It is assumed that the purchased number of shares may not be an integer

The work consists of the following steps:
1) Using data from https://finance .yahoo.com historical quotes of the selected stock are loaded
2) Starting from the specified starting date, the data necessary for delta hedging of the sold stock option is calculated. For each day of observation, additional quotes are loaded for the number of years specified by the user. This data is necessary to calculate the Andersen Darling criterion, which is used in this work in order to find a point in time in the past that creates the maximum difference in the empirical distributions of stock returns before this point and after. Based on this criterion, it is assumed that quotes belonging to the period after the calculated point in time in the past show relevant stock`s data. These data are used to calculate the volatility of an asset based on historical returns. Every 20 days, the volatility for the asset is recalculated. This is explained by the fact that with small shifts in time (<20 days), the dividing point in time does not change and therefore changes in volatility are negligible
3) The volatility calculated in the previous paragraph and other parameters entered by the user are used to calculate the option price and its delta using the Black-Scholes option formula
4) Then the following rule works: if the delta is > 0.5, then you need to buy the appropriate number of shares and also continue to buy until the delta stops growing. If the delta decreases, it is necessary to sell the number of shares based on the change in the delta value
5) The table with the result stores historical quotes of the price, option prices, delta options, a description of the necessary action, the number of shares that must be purchased for each day of the time period for optimal delta hedging
